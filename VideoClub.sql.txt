https://codeshare.io/a39Mxv
https://docs.google.com/document/d/1HSeVvEZzdeE-hoXUTvMXvyH8VZ1ZroPcMofMHaQptt0/edit?usp=sharing

https://drive.google.com/drive/folders/1oJBtbdu1jaxT_3PudMrVZ3EaBf4ie7D0?usp=sharing


/*
drop table DistinguerProfessionnel;
drop table DistinguerFilm;
drop table Distinguer;
drop table Distinction;
drop table Participer;
drop table Sous_titrer;
drop table Vocaliser;
drop table Langue;
drop table LouerPhys;
drop table Physique;
drop table LouerNum;
drop table Numérique;
drop table Version;
drop table Film;
drop table Professionnel;
drop table Abonné;
drop table Abonnement;
drop table Personne;
*/

Create table Personne(
Nom				varchar(25),
Prenom			Varchar(25),
DateNaiss			Date check(DateNaiss <= getdate()),
Primary Key(Nom, Prenom, DateNaiss)
);
Create table Abonnement(
Nom				varchar(25) primary key,
Prix				smallint,
LocationMax			smallint,
DureeLoc			integer
);
Create table Abonné(
Numero			smallint Unique,
Adresse			varchar(52),
Téléphone			integer,
Renouvellement		date,
Ancienneté			smallint,
Politique			tinyint,
Nom				varchar(25),
Prenom			varchar(25),
DateNaiss			date check((YEAR(getdate()) - YEAR(DateNaiss)) >= 6),
Nom_Abonnement		varchar(25),
primary key (Nom,Prenom,DateNaiss),
Constraint fk1_abonne Foreign key(Nom, Prenom, DateNaiss) references Personne(Nom, Prenom, DateNaiss)	on delete cascade,
Constraint fk2_abonne Foreign key (Nom_Abonnement) references Abonnement(Nom) on update cascade on delete set NULL
);
Create table Professionnel(
Filmographie			text,
Biographie			text,
Caractéristique		text,
Nom				varchar(25),
Prenom			varchar(25),
DateNaiss			date check(DateNaiss <= getdate()),
primary key (Nom, Prenom, DateNaiss),
Constraint fk1_pro Foreign key(Nom, Prenom, DateNaiss) references Personne(Nom, Prenom, DateNaiss) on delete cascade
);
Create table Film(
TitreVF				varchar(52) primary key,
TitreVO			varchar(52),
Site				varchar(25),
Generique			text,
Resume			text,
VO				varchar(25) 
);
Create table Version(
DateV				date NOT NULL check(DateV <= getdate()),
Pays				varchar(25) NOT NULL ,
Edition				varchar(25) NOT NULL ,
DRM				varchar(25) ,
PEGI				tinyint check(PEGI <= 18),
Duree				time,
TitreVF				varchar(52) NOT NULL,
PRIMARY KEY (TitreVF, DateV ,Pays ,Edition),
constraint fk1_version foreign key (TitreVF) references Film(TitreVf) on update cascade on delete cascade 
);  
Create table Numérique(
TitreVF				varchar(52),
Prix 				smallint,
DateV				date,
Pays				varchar(25),
Edition				varchar(25),
primary key (TitreVF,DateV,Pays,Edition),
constraint fk1_Numérique foreign key (TitreVF,DateV,Pays,Edition) references Version(TitreVF,DateV,Pays,Edition) on update cascade on delete cascade 
);
Create table LouerNum(
DateDebut			date check(DateDebut <= getdate()),
DateFin			date,
TitreVF				varchar(52),
DateV				date,
Pays				varchar(25),
Edition				varchar(25),
Nom				varchar(25),
Prenom			varchar(25),
DateNaiss			date,
Force 				Integer Default(0),
Primary Key(Nom, Prenom, DateNaiss, TitreVF, DateDebut),
constraint checkNum check(DateFin > DateDebut),
constraint fk1_LouerNum foreign key (Nom,Prenom,DateNaiss) references Abonné(Nom,Prenom,DateNaiss) on update cascade on delete NO Action,
constraint fk2_LouerNum foreign key (TitreVF,DateV,Pays,Edition) references Numérique(TitreVF,DateV,Pays,Edition) on update no action on delete cascade
);
Create table Physique(
id				smallint,
TitreVF				varchar(52),
Etat				tinyint,
Support			varchar(25),
Prix				float,
DateV				date,
Pays				varchar(25),
Edition				varchar(25),
primary key(id,Pays,DateV,Edition,TitreVF),
constraint fk1_Physique foreign key (TitreVF,DateV,Pays,Edition) references Version(TitreVF,DateV,Pays,Edition) on update cascade on delete no action
);         
Create table LouerPhys(
DateDebut			date check(DateDebut <= getdate()),
DateFin			date ,
id				smallint,
TitreVF				varchar(52),
DateV				date,
Pays				varchar(25),
Edition				varchar(25),
Nom 				varchar(25),
Prenom			varchar(25),
DateNaiss 			date,
Force 				Integer Default(0),
Primary Key(Nom, Prenom, DateNaiss, TitreVF, DateDebut),
constraint checkPhy check(DateFin > DateDebut),
constraint fk1_LouerPhys foreign key (id,Pays,DateV,Edition,TitreVF) references Physique(id,Pays,DateV,Edition,TitreVF) on update no action on delete cascade,
constraint fk2_LouerPhys foreign key (Nom,Prenom,DateNaiss) references Abonné(Nom,Prenom,DateNaiss) on update no action on delete No action
);
Create table Langue(
Langue			varchar(25) primary key
);
Create table Vocaliser(
DateV				date not null,
Pays				varchar(25) not null,
Edition				varchar(25) not null,
TitreVF				varchar(52) NOT NULL ,
Langue			varchar(25) NOT NULL ,
Primary Key(DateV, Pays, Edition, TitreVF, Langue),
constraint fk1_Vocaliser foreign key (TitreVF, DateV ,Pays ,Edition) references Version (TitreVF,DateV,Pays,Edition) on update cascade on delete no action,
constraint fk2_Vocaliser foreign key (Langue) references langue(Langue) on update cascade on delete no action
);
Create table Sous_Titrer(
Langue			varchar(25) NOT NULL ,
DateV				date NOT NULL ,
Pays				varchar(25) NOT NULL ,
Edition				varchar(25) NOT NULL ,
TitreVF				varchar(52) NOT NULL ,
Primary Key(DateV, Pays, Edition, TitreVF, Langue),
constraint fk1_Sous_Titrer foreign key (Langue) references langue(Langue) on update cascade on delete no action,
constraint fk2_Sous_Titrer foreign key (TitreVF, DateV ,Pays ,Edition) references Version(TitreVF, DateV ,Pays ,Edition) on update cascade on delete no action
);
Create table Participer(
Role      			Varchar (25) ,
TitreVF   			Varchar (52) NOT NULL ,
Nom       			Varchar (25) NOT NULL ,
Prenom    			Varchar (25) NOT NULL ,
DateNaiss 			Date NOT NULL,
Primary Key(Nom, Prenom, DateNaiss, Role, TitreVF),
constraint fk1_Participer foreign key (TitreVF) references Film(TitreVF) on update cascade on delete no action,
constraint fk2_Participer foreign key (Nom,Prenom,DateNaiss) references Personne(Nom ,Prenom ,DateNaiss) on update cascade on delete no action
);
CREATE TABLE Distinction(
Nom       			varchar(25) NOT NULL ,
Categorie 			varchar(25) NOT NULL ,
Lieu      			varchar(25) NOT NULL ,
constraint pk_Distinction PRIMARY KEY (Nom ,Categorie ,Lieu)
);
Create table Distinguer(
DateD				date check(DateD <= getdate()),
TitreVF				varchar(52) NOT NULL ,
Nom				varchar(25) NOT NULL ,
Prenom			varchar(25) NOT NULL ,
DateNaiss			date NOT NULL,
Nom_Distinction		varchar(25) NOT NULL ,
Categorie			varchar(25) NOT NULL ,
Lieu				varchar(25) NOT NULL ,
Primary Key(Nom, Prenom, DateNaiss, TitreVF, Nom_Distinction, categorie, Lieu),
constraint fk1_distinguer FOREIGN KEY (TitreVF) REFERENCES Film(TitreVF) on update cascade on delete no action,
constraint fk2_distinguer FOREIGN KEY (Nom, Prenom, DateNaiss) REFERENCES Personne(Nom, Prenom, DateNaiss) on update cascade on delete no action,
constraint fk3_distinguer FOREIGN KEY (Nom_Distinction,Categorie,Lieu) REFERENCES Distinction(Nom,Categorie,Lieu) on update cascade on delete no action
);
Create table DistinguerFilm(
DateD				date check(DateD <= getdate()),
TitreVF				varchar(52) NOT NULL ,
Nom				varchar(25) NOT NULL ,
Categorie			varchar(25) NOT NULL ,
Lieu				varchar(25) NOT NULL ,
Primary Key(Nom, Categorie, Lieu, TitreVF),
constraint fk1_distinguerFilm FOREIGN KEY (TitreVF) REFERENCES Film(TitreVF) on update cascade on delete no action,
constraint fk2_distinguerFilm FOREIGN KEY (Nom,Categorie,Lieu) REFERENCES Distinction(Nom,Categorie,Lieu) on update cascade on delete no action
);
Create table DistinguerProfessionnel(
DateD				date check(DateD <= getdate()),
Nom				varchar(25) NOT NULL ,
Categorie			varchar(25) NOT NULL ,
Lieu				varchar(25) NOT NULL ,
Nom_Personne		varchar(25) NOT NULL ,
Prenom			varchar(25) NOT NULL ,
DateNaiss			date NOT NULL ,
Primary Key(Nom_Personne, Prenom, DateNaiss, Nom, Categorie, Lieu),
constraint fk1_distinguerPro FOREIGN KEY (Nom,Prenom,DateNaiss) REFERENCES Personne(Nom,Prenom,DateNaiss) on update cascade on delete no action,
constraint fk2_distinguerPro FOREIGN KEY (Nom,Categorie,Lieu) REFERENCES Distinction(Nom,Categorie,Lieu) on update cascade on delete no action
);



////////


Insert into Film
values ('Demandez la Permission aux Enfants','Demandez la Permission aux Enfants',NULL,'Réalisation : Éric Civanyan, Scénario et dialogues : Guillaume Breton et Éric Civanyan, d''après une idée originale de Guillaume Breton , Directeur de production : Gilles Loutfi, Producteur délégué : Manuel Munz, Chef décorateur : Jean-luc Raoul, Directeur de la photographie : Stéphane Cami, Mixage : François Groult, Directeur de la photographie : Stéphane Cami, Chef costumière : Anne Brault, Chef décorateur : Jean-luc Raoul, Chef monteur : Aurique Delannoy, Effets spéciaux (balançoire) : François Philippi, Luis Gutierrez-pino, Autres effets spéciaux numériques : L’Étude et la Supervision des Trucages (François Vagnon), Dessins/Illustrateur BD : François Duprat, Photographe de plateau : Arnaud Borrel, Musique originale : François Peyrony, Coordination : Laurent Juillet'
,'Trois familles sont confrontées à un seul et même problème : leurs enfants leur mènent la vie dure. Et puis un jour, la bêtise de trop et voilà que les adultes décident d''unir leurs forces pour rendre à ces petits diables la monnaie de leur désobéissance. Entre les enfants rois et les parents rebelles, désormais, tous les coups sont permis.','Français');
insert into Film
values('Intouchables','Intouchables',NULL,'Réalisation, scénario et dialogues : Olivier Nakache et Éric Toledano, d''après le livre Le Second Souffle de Philippe Pozzo di Borgo ,Décors : François Emmanuelli, Costumes : Isabelle Pannetier,Photographie : Mathieu Vadepied,Montage : Dorian Rigal-Ansous,Musique : Ludovico Einaudi,Supervision musicale : Alexandra Arnould et Sylvano Santorio,Son : Pascal Armant et Jean-Paul Hurier
,Casting : Gigi Akoka (A.R.D.A),Prises de vues : Panavision, Kodak et Fujifilm,Producteurs : Nicolas Duval, Yann Zenou et Laurent Zeitoun,Sociétés de production : Gaumont, TF1 Films Production, Quad Productions, Chaocorp, Ten Films,Participations à la production : Canal +, TF1, Cinémage 4 Développement et Cinécinéma,Post-production : DUBOI, LTC, SCANLAB et Cinestereo,Sociétés de distribution : Gaumont (France), The Weinstein Company (États-Unis),Banques : Natixis-Coficiné et Neuflize-OBC,Assurances : Allianz','A la suite d’un accident de parapente, Philippe, riche aristocrate, engage comme aide à domicile Driss, un jeune de banlieue tout juste sorti de prison. Bref la personne la moins adaptée pour le job. Ensemble ils vont faire cohabiter Vivaldi et Earth Wind and Fire, le verbe et la vanne, les costumes et les bas de survêtement... Deux univers vont se télescoper, s’apprivoiser, pour donner naissance à une amitié aussi dingue, drôle et forte qu’inattendue, une relation unique qui fera des étincelles et qui les rendra... Intouchables','français');
insert into Film
values('Titanic','Titanic',NULL,'Réalisation : James Cameron,Scénario : James Cameron,Direction artistique : Martin Laing, Charles Dwight Lee,Décors : Peter Lamont,Costumes : Deborah Lynn Scott,Son : Christopher Boyes,Photographie : Russell Carpenter,Montage : Conrad Buff, James Cameron, Richard A. Harris,Musique: James Horner,Production : James Cameron et Jon Landau (producteurs), Rae Sanchini (no) (producteur délégué), Al Giddings, Grant Hill et Sharon Mann (en) (coproducteurs), Pamela Easley (productrice associée),Sociétés de production : 20th Century Fox, Paramount Pictures et Lightstorm Entertainment,Sociétés de distribution : 20th Century Fox (International), Paramount Pictures (Canada et États-Unis),Sociétés d''effets spéciaux : Digital Domain, Industrial Light & Magic',
'Southampton, 10 avril 1912. Le paquebot le plus grand et le plus moderne du monde, réputé pour son insubmersibilité, le "Titanic", appareille pour son premier voyage. Quatre jours plus tard, il heurte un iceberg. A son bord, un artiste pauvre et une grande bourgeoise tombent amoureux.','anglais');
insert into Film
values('Avatar','Avatar',NULL,'Réalisation et scénario : James Cameron,Décors : Rick Carter et Robert Stromberg,Costumes : Mayes C. Rubeo et Deborah Lynn Scott,Photographie : Mauro Fiore,Montage : James Cameron, John Refoua (en) et Stephen E. Rivkin (en),Musique : James Horner,Production : James Cameron et Jon Landau,Co-production : Brooke Breton et Josh McLaglen,Production associée : Janace Tashjian,Production déléguée : Colin Wilson,Production exécutive : Peter M. Tobyansen,Sociétés de production : 20th Century Fox, Dune Entertainment, Giant Studios, Ingenious Film Partners, Lightstorm Entertainment,Société de distribution : 20th Century Fox','Malgré sa paralysie, Jake Sully, un ancien marine immobilisé dans un fauteuil roulant, est resté un combattant au plus profond de son être. Il est recruté pour se rendre à des années-lumière de la Terre, sur Pandora, où de puissants groupes industriels exploitent un minerai rarissime destiné à résoudre la crise énergétique sur Terre. Parce que l''atmosphère de Pandora est toxique pour les humains, ceux-ci ont créé le Programme Avatar, qui permet à des " pilotes " humains de lier leur esprit à un avatar, un corps biologique commandé à distance, capable de survivre dans cette atmosphère létale. Ces avatars sont des hybrides créés génétiquement en croisant l''ADN humain avec celui des Na''vi, les autochtones de Pandora.
Sous sa forme d''avatar, Jake peut de nouveau marcher. On lui confie une mission d''infiltration auprès des Na''vi, devenus un obstacle trop conséquent à l''exploitation du précieux minerai. Mais tout va changer lorsque Neytiri, une très belle Na''vi, sauve la vie de Jake…','anglais');
insert into Film
values('Protéger et Servir','Protéger et Servir',NULL,'Scénario : Éric Lavaine et Héctor Cabello Reyes,d''après la série Le 17 écrite par Jean-Paul Bathany, Éric Lavaine, Bruno Nicolini, Alexandre Pesle et Frédéric Proust,Costumes : Catherine Bouchard,Photographie : Stéphane Cami,Montage : Vincent Zuffranieri,Production : Vincent Roget et François Cornuau,Sociétés de distribution : Pathé LexardPictures','Kim Houang et Michel Boudriau sont deux flics "à la vie à la mort" depuis qu''ils se sont croisés à l''orphelinat.
Michel Boudriau est un flic très marqué par l''éducation catholique qu''il a reçu à l''orphelinat. De cet enseignement salutaire, il a retenu des valeurs qui font honneur à la police française : le pardon, le partage, la compassion....
Kim Houang a été adopté à la naissance par un couple de restaurateurs vietnamiens avant d''être placé à l''orphelinat... Kim a conservé quelques traits hérités de sa petite enfance dans la communauté asiatique, notamment un amour immodéré pour cet art millénaire qu''est le karaoké.
Kim a plusieurs gros soucis dans la vie, il est maladivement radin et plaît beaucoup aux filles à physique difficile...
Ce ne sont pas les meilleurs flics de France, ni de la région parisienne, ni de leur commissariat... et pourtant ce sont eux qui, sous les ordres d''Aude Lettelier, directeur de la police nationale, sont chargés de déjouer une vague d''attentats qui touche notre beau pays.','français');
insert into Film
values('Brice de Nice','Brice de Nice','www.bricedenice.com','Scénario : Karine Angeli, Jean Dujardin et James Huth,Production : Éric et Nicolas Altmayer,Société de production : Mandarin Production, M6 Films, avec la participation de Canal+, CinéCinéma,Photographie : Philippe Piffeteau & Bertrand Bijou,Montage : James Huth & Antoine Vareille,Costumes : Sandrine Weill,Musique : Bruno Coulais,Distribution : France : TFM Distribution,Format : 1,85:1 - Couleurs - Son DTS, Dolby Digital 5.1,Genre : Comédie,Durée : 98 minutes','Brice Agostini mène la belle vie à Nice. Il est fan du film Point Break et en particulier de son personnage principal Bodhi joué par Patrick Swayze. Il attend chaque jour qu''une vague géante déferle sur les rives de Nice, comme cela a eu lieu une fois, en 1979.
Ainsi, il ne se déplace jamais sans sa planche de surf. En attendant, aucune vague à Nice ne permet de surfer. Son passe-temps est d''organiser des soirées festives assez "select", appelées "Yellow" où il participe à des joutes verbales dont le perdant (toujours l''autre) est jeté dans la piscine.
Sa vie se déroule dans l''insouciance, jusqu''au jour où son père, qui blanchissait de l''argent pour la mafia sicilienne, est arrêté. Ses biens sont saisis par la police et la domestique de maison se voit contrainte de démissionner. Brice, qui n''a jamais travaillé se retrouve sans un sou et perdant brutalement ses amis, découvre la vie. Il s''essaie à un emploi de serveur dans un restaurant, mais se fait renvoyer au bout d''une journée après en avoir inondé la cuisine. Il tente de braquer une banque, d''abord en reproduisant la scène du hold-up de Point Break, puis en chantant Le casse de Brice, et finit par fuir la police.
Pendant sa fuite, il rencontre Marius Lacaille, un marginal souffrant de difficultés à s''exprimer. Marius apprend qu''il y a une compétition de surf à Hossegor, avec 100 000 $ de prix, montant suffisant pour se payer une opération des pieds, les siens ressemblant à de gros pouces sans autres orteils.
Sur place, la concurrence est rude : il y a Igor d''Hossegor, le maître des lieux, mais aussi Jibé du Tibet, Babacar de Dakar, Loïc du Croisic, Arnaud de Lacanau, Nikos de Myconos. N''ayant jamais surfé sur des vraies vagues, Brice va échouer lamentablement. Comme Brice n''a pas gagné l''argent tant espéré, Marius doit renoncer à son opération des pieds ; ce dernier aura toutefois rencontré l''amour en la personne de Jeanne, une jeune femme aux oreilles gigantesques.
De retour à Nice, Brice travaille au nettoyage de plages. Et sa vague tant attendue déferle sur les côtes de Nice, qu''il réussira à surfer. À peine la vague terminée, il rencontre son alter-ego féminin, Alice de Nice, dont il avait rêvé plusieurs fois, la voyant en sirène. On les voit ensemble, après le générique, avec Marius et Jeanne faire le tour du monde ; Brice est enceinte comme dans son rêve, car chez les sirènes, c''est le mâle qui porte le petit.','Français');
insert into Film values
('Terminator','The Terminator',NULL,'Scénario : James Cameron et Gale Anne Hurd
Dialogues additionnels : William Wisher,Direction artistique : George Costello,Costumes : Hilary Wright,Modélisation du Terminator : Stan Winston (directeur de la seconde équipe/effets spéciaux),Photographie : Adam Greenberg,Effets spéciaux : Roger George et Frank DeMarco (pour Fantasy II Film Effects),Son : Richard Lightstone,Montage : Mark Goldblatt,Musique : Brad Fiedel,Production : Gale Anne Hurd, John Daly et Derek Gibson,Sociétés de production : Hemdale Film Corporation, Pacific Western Productions, Euro Film Funding et Cinema 84,Société de distribution : Orion Pictures ,Entertainment One 20th Century Fox,Format : Couleurs - 35 mm - 1,85:1 - Son stéréo,Genre : science-fiction, thriller, action,Durée : 107 min','A Los Angeles en 1984, un Terminator, cyborg surgi du futur, a pour mission d''exécuter Sarah Connor, une jeune femme dont l''enfant à naître doit sauver l''humanité. Kyle Reese, un résistant humain, débarque lui aussi pour combattre le robot, et aider la jeune femme... ','Anglais');
insert into Film values
('Les Trois Frères','Les Trois Frères',NULL,'Scénario : Didier Bourdon, Bernard Campan et Michel Lengliney,Direction artistique : Christian Marti,Décors : Christian Marti,Costumes : Véronique Pouzou et Gisèle Ravard,Photographie : Alain Choquart,Montage : Gérard Klotz,Musique : Didier Bourdon et Olivier Bernard,Chanson « Doux Daddy » interprétée par : Catherine Ringer et Didier Bourdon,Production : Claude Berri, Patrick Bordier, Ségolène Fleury-Slimane, Alexandre Lederman et Paul Lederman,Société de distribution : Pathé,Budget : 7,15 M €,Langue : français,Format : 1,85:1,Genre : comédie','Trois frères, qui ne se connaissent pas, sont convoqués devant un notaire pour prendre possession d''un héritage de 3 millions de francs de leur mère chanteuse, décédée depuis deux ans aux États-Unis.
Les trois frères ont eu des parcours et des niveaux de vie très différents : Didier est vigile dans un supermarché, accumule les conquêtes d’un soir, et s''amuse à lire Michel de Montaigne ; Bernard est un comédien sans succès qui vit d''expédients ; Pascal travaille dans une agence de communication branchée, discret et la tête sur les épaules.
Lorsqu''ils reviennent deux jours plus tard chez le notaire, les trois frères apprennent qu''ils ne peuvent plus prétendre à l''héritage, le délai ayant expiré depuis deux jours. Cette nouvelle déclenche une série de péripéties, dont l''arrivée de Michaël, le fils d''une des anciennes conquêtes de Didier, vient pimenter plus encore leurs aventures.','Français');
insert into Film
values('The Revenant','The Revenant',NULL,'Scénario : Alejandro González Iñárritu et Mark L. Smith, d''après Le Revenant de Michael Punke,Direction artistique : Jack Fisk;Décors : Michael Diner,Costumes : Jacqueline West,Photographie : Emmanuel Lubezki,Montage : Stephen Mirrione,Musique : Ryuichi Sakamoto, Alva Noto et Bryce Dessner,Production : Megan Ellison, Steve Golin, Alejandro González Iñárritu, David Kanter, Arnon Milchan, Keith Redmon et James W. Skotchdopole,Sociétés de production : Anonymous Content, New Regency Pictures et RatPac Entertainment,Société de distribution : 20th Century Fox,Format : couleur - 2,35:1 - son Dolby numérique - 35 mm,Genre : western,Durée : 156 minutes','Dans une Amérique profondément sauvage, Hugh Glass, un trappeur, est attaqué par un ours et grièvement blessé. Abandonné par ses équipiers, il est laissé pour mort. Mais Glass refuse de mourir. Seul, armé de sa volonté et porté par l’amour qu’il voue à sa femme et à leur fils, Glass entreprend un voyage de plus de 300 km dans un environnement hostile, sur la piste de l’homme qui l’a trahi. Sa soif de vengeance va se transformer en une lutte héroïque pour braver tous les obstacles, revenir chez lui et trouver la rédemption.' ,'Anglais');
insert into Film
values('Le Choc des Titans','Clash of the Titans',NULL,'Scénario : Beverley Cross,Décors : Frank White,Costumes : Emma Porteus,Photographie : Ted Moore,Montage : Timothy Gee,Musique : Laurence Rosenthal,Production : Ray Harryhausen et Charles H.Schneer,Société de production et de distribution : Metro-Goldwyn-Mayer,Genre : Aventure, péplum, fantastique, fantasy,Durée : 118 minutes','Vingt ans après que le roi d''Argos l''ait condamné à l''exil, Persée, le fils de Zeus et d''une mortelle Danaé, doit reconquérir le royaume qui lui appartient. Soutenu par son père, il commence par libérer la princesse Andromaque, et en tombe éperdument amoureux. Mais la déesse Thétis et son fils, Calibos font peser sur la belle une terrible malédiction : tous ceux voulant l''épouser devront, sous peine de mort, répondre à une énigme. Jusqu''ici, aucun n''a su trouver la bonne réponse...Qu''à cela ne tienne, Persée a bien l''intention de défier la puissance des dieux et de braver mille dangers pour réaliser l''impossible : affronter des sorcières démoniaques et cannibales, combattre le cerbère, trancher la tête de Méduse, une créature capable de changer ses victimes en statues de pierres... ','Anglais');
insert into Personne Values('Cameron','James', '1954-08-16');
insert into Personne Values('DiCaprio','Leonardo', '1974-09-11');;
insert into Personne Values('Winslet','Kate', '	1975-10-5');
insert into Personne Values('Civanyan','Éric', '1974-01-01');
insert into Personne Values('Breton','Guillaume', '1974-01-01');
insert into Personne Values('Bonnaire','Sandrine', '1967-05-31');
insert into Personne Values('Légitimus','Pascal', '1959-05-13');
insert into Personne Values('Parillaud','Anne', '1960-06-06');
insert into Personne Values('Cassignard','Pierre', '1965-12-19');
insert into Personne Values('Nakache','Olivier', '1973-05-15');
insert into Personne Values('Toledano','Éric', '1971-07-03');
insert into Personne Values('Cluzet','François', '1955-09-21');
insert into Personne Values('Sy','Omar', '1978-01-20');
insert into Personne Values('Worthington','Sam', '1976-08-02');
insert into Personne Values('Saldana','Zoe', '1978-07-19');
insert into Personne Values('Weaver','Sigourney', '1949-09-08');
insert into Personne Values('Rodríguez','Michelle', '1978-07-12');
insert into Personne Values('Ribisi','Giovanni', '1974-12-17');
insert into Personne Values('Lavaine','Éric', '1962-09-15');
insert into Personne Values('Merad','Kad', '1964-03-27');
insert into Personne Values('Cornillac','Clovis', '1968-08-16');
insert into Personne Values('Bouquet','Carole', '1957-08-18');
insert into Personne Values('Damiens','François', '1973-01-17');
insert into Personne values('Cherazade','Atila','1964-01-31');
insert into Personne values('Ramnstein','Leindeneim','0001-12-30');
insert into Personne values('Jenova','Sephiroth','1963-10-23');
insert into Personne values('Christ','Jesus','1984-08-22');
insert into Personne values('Javoue','Jaitord','1990-12-28');
insert into Personne values('Wowday','Henrie','1968-11-20');
insert into Personne values('Wowday','Henry','1968-10-17');
insert into Personne values('Whereday','Charle','1968-09-16');
insert into Personne values('Whenday','Thebase','1984-08-11');
insert into Personne values('Allo','Mais','1929-06-21');
insert into Personne values('Allo','Nanmais','1980-02-24');
insert into Personne values('Wenenensday','Drop','2010-07-14');
insert into Personne values('Tuesday','Mark','1999-06-19');
insert into Personne values('Monday','Fetch','1968-05-11');
insert into Personne values('Soppyday','Joe','1948-04-04');
insert into Personne values('Holliday','Yarl','1967-03-08');
insert into Personne values('DeFontenay','Eris','1964-02-02');
insert into Personne values('Albert','Camus','1952-01-01');
insert into Personne values('Weshwesh','lesamis','1995-04-26');
 
insert into Abonnement values ('Asticot',123,5,15);
insert into Abonnement values ('SuperAsticot',231,10,20);
insert into Abonnement values ('SousAsticot',312,15,30);
 
insert into Abonné values (32767,'12 rue Vindieux 34278', 0615478932, '2017-12-31', 1,0, 'Albert', 'Camus','1952-01-01','SuperAsticot');
insert into Abonné values (5863,'93 avenue des paillottes 11687',0684358751,'2017-12-12',0,0,'DeFontenay','Eris','1964-02-02','SousAsticot');
insert into Abonné values (2519,'22 impasse des cassettes dures 84135',0623549441,'2017-12-18',0,0,'Holliday','Yarl','1967-03-08','SuperAsticot');
insert into Abonné values (185,'233 boulevard GrandeRue 71869',0648356597,'2017-12-11',1,1,'Soppyday','Joe','1948-04-04','SousAsticot');
insert into Abonné values (9872,'34 rue des marecharlie 22135',06483565,'2017-12-28',2,1,'Monday','Fetch','1968-05-11','SousAsticot');
insert into Abonné values (19872,'1330 impasse des restraints 75034',0648351565,'2017-12-07',3,0,'Tuesday','Mark','1999-06-19','SuperAsticot');
insert into Abonné values (15,'2 ter rue jolie jolie 48653',0648963565,'2017-12-19',4,1,'Wenenensday','Drop','2010-07-14','SuperAsticot');
insert into Abonné values (684,'8 bis rue des enjoliveurs 48653',0648345565,'2017-12-22',1,2,'Whenday','Thebase','1984-08-11','SuperAsticot');
insert into Abonné values (21456,'45 avenue des avenues 22468',0648357565,'2017-12-13',0,0,'Whereday','Charle','1968-09-16','SousAsticot');
insert into Abonné values (11111,'11111 autoroute A1',0648356485,'2018-01-30',1,4,'Wowday','Henry','1968-10-17','Asticot');
insert into Abonné values (9684,'81 rue des rues 41287',0648357365,'2018-02-28',0,5,'Wowday','Henrie','1968-11-20','SousAsticot');
insert into Abonné values (1984,'22 rue des keufs 75001',0648973565,'2018-02-18',2,4,'Javoue','Jaitord','1990-12-28','SousAsticot');
insert into Abonné values (19851,'115 avenue des cables 56843',0648423565,'2017-11-25',3,0,'Allo','Nanmais','1980-02-24','SuperAsticot');
insert into Abonné values (31574,'34 rue des epoustouflants 68423',0648953565,'2017-12-21',5,0,'Weshwesh','lesamis','1995-04-26','Asticot');
insert into Abonné values (9811,'39 rue des barbarismes 89563',0648453565,'2017-11-16',4,1,'Allo','Mais','1929-06-21','SuperAsticot');
insert into Abonné values (9011,'2 bis rue des dés',0648352865,'2018-01-16',1,5,'Christ','Jesus','1984-08-22','SuperAsticot');
insert into Abonné values (248,'2 bis rue des dés',0648356315,'2018-04-16',24,0,'Jenova','Sephiroth','1963-10-23','Asticot');
insert into Abonné values (626,'2 bis rue des dés',0648753565,'2016-11-11',32000,1,'Ramnstein','Leindeneim','0001-12-30','SousAsticot');
insert into Abonné values (666,'123 rue des Jamais 93687',0648357565,'2016-04-19',1576,5,'Cherazade','Atila','1964-01-31','Asticot');

insert into Professionnel Values('Terminator, Aliens, le retour, Abyss,True Lies, Titanic, Avatar','James Francis Cameron est un réalisateur, scénariste, producteur et explorateur de fonds marins canadien, né le 16 août 1954 à Kapuskasing (Canada). ',NULL, 'Cameron','James', '1954-08-16');
insert into Professionnel Values('Titanic, The Revenant, Le Loup de Wall Street','Leonardo DiCaprio, né le 11 novembre 1974 à Los Angeles, est un acteur, scénariste et producteur de cinéma américain.', NULL, 'DiCaprio','Leonardo', '1974-09-11');
insert into Professionnel Values('Titanic, Eternal Sunshine of the Spotless Mind, The Reader, Divergente, Steve Jobs', 'Kate Winslet est une actrice britannique, née le 5 octobre 1975 à Reading (Angleterre).', Null, 'Winslet','Kate', '1975-10-5');
insert into Professionnel Values('Tout baigne, Il ne faut jurer de rien !, Demandez la permission aux enfants','Éric Civanyan est un acteur et réalisateur de cinéma et de télévision français.', Null,'Civanyan','Éric', '1974-01-01');
insert into Professionnel Values('Demandez la permission aux enfants', 'Guillaume Breton est un Scénariste, Auteur, Dialoguiste', Null,'Breton','Guillaume', '1974-01-01');
insert into Professionnel Values('Demandez la permission aux enfants, À nos amours, Sans toit ni loi, Jeanne la Pucelle, La Cérémonie, Joueuse','Sandrine Bonnaire, née le 31 mai 1967 à Gannat (Allier), est une actrice, réalisatrice et scénariste française.', Null, 'Bonnaire','Sandrine', '1967-05-31');
insert into Professionnel Values('Demandez la permission aux enfants, Les Trois Frères, Antilles sur Seine, Les Rois mages, Madame Irma, Les Trois Frères : Le Retour, À votre service','Pascal Légitimus est un humoriste, acteur et réalisateur français, né le 13 mars 1959 à Paris, d''une mère française d''origine arménienne et d''un père antillais. Il fait partie du célèbre trio comique des Inconnus.', Null,'Légitimus','Pascal', '1959-05-13');
insert into Professionnel Values('Demandez la permission aux enfants, Nikita, L''Homme au masque de fer','Anne Parillaud, née le 6 mai 1960 dans le 12e arrondissement de Paris, est une actrice française.', Null,'Parillaud','Anne', '1960-06-06');
insert into Professionnel Values('Demandez la permission aux enfants','Pierre Cassignard est un acteur et metteur en scène français né le 19 décembre 1965 à Sainte-Foy-la-Grande (Gironde).', Null,'Cassignard','Pierre', '1965-12-19');
insert into Professionnel Values('Nos jours heureux, Tellement proches, Intouchables, Samba','Olivier Nakache, né le 15 avril 1973 à Suresnes, est un réalisateur, scénariste et dialoguiste français.', Null,'Nakache','Olivier', '1973-05-15');
insert into Professionnel Values('Nos jours heureux, Tellement proches, Intouchables','Éric Toledano est un réalisateur, scénariste et dialoguiste français né le 3 juillet 1971 à Paris. Il travaille en binôme avec Olivier Nakache à la fois pour l''écriture et la réalisation.', Null,'Toledano','Éric', '1971-07-03');
insert into Professionnel Values('Association de malfaiteurs, Ne le dis à personne, Les Petits Mouchoirs, Intouchables, Médecin de campagne','François Cluzet est un acteur français, né le 21 septembre 1955 dans le 9e arrondissement de Paris.', Null,'Cluzet','François', '1955-09-21');
insert into Professionnel Values('Intouchables, De l''autre côté du périph, Samba, Jurassic World, Demain tout commence, X-Men: Days of Future Past','Omar Sy, né le 20 janvier 1978 à Trappes (Yvelines), est un acteur et humoriste français. Il accède à la notoriété en formant, avec Fred Testot, le duo comique Omar et Fred.', Null,'Sy','Omar', '1978-01-20');
insert into Professionnel Values('Terminator Renaissance, Avatar, Le Choc des Titans, Dos au mur, Everest','Sam Worthington est un acteur, réalisateur et scénariste australien, né le 2 août 1976 à Godalming dans le Surrey (Angleterre).', Null,'Worthington','Sam', '1976-08-02');
insert into Professionnel Values('Avatar, Star Trek, The Losers, Colombiana, Les Gardiens de la Galaxie','Zoe Saldana Perego1, née le 19 juin 1978 à Passaic (New Jersey), est une actrice, réalisatrice et productrice américano-dominicaine.', Null,'Saldana','Zoe', '1978-07-19');
insert into Professionnel Values('Alien, Avatar','Susan Weaver, dite Sigourney Weaver, née le 8 octobre 1949, à New York, est une actrice américaine.', Null,'Weaver','Sigourney', '1949-09-08');
insert into Professionnel Values('Resident Evil, Saga Fast and Furious, Avatar','Michelle Rodríguez est une actrice américaine, d''origine dominicaine et portoricaine, née le 12 juillet 1978 à San Antonio (Texas).', Null,'Rodríguez','Michelle', '1978-07-12');
insert into Professionnel Values('Il faut sauver le soldat Ryan, 60 secondes chrono, Lost in Translation, Avatar, Contrebande, Gangster Squad','Giovanni Ribisi est un acteur américain, né le 17 décembre 1974 à Los Angeles.', Null,'Ribisi','Giovanni', '1974-12-17');
insert into Professionnel Values('Protéger et servir', 'Éric Lavaine, est un réalisateur et scénariste français, né le 15 septembre 1962 à Paris.', Null,'Lavaine','Éric', '1962-09-15');
insert into Professionnel Values('Protéger et servir, Mais qui a tué Pamela Rose ?, Les Choristes, Je vais bien, ne t''en fais pas, Bienvenue chez les Ch''tis, Le Petit Nicolas, Supercondriaque','Kad Merad, de son vrai nom Kaddour Merad, est un comédien, humoriste et réalisateur franco-algérien1, né le 27 mars 1964 à Sidi Bel Abbès en Algérie et ayant passé la majorité de son enfance à Balbigny (Loire) avant de déménager à dix ans à Ris-Orangis (Essonne). Il se fait d''abord connaître en formant, avec Olivier Baroux, le duo Kad et Olivier, puis s''affirme en solo tout en retravaillant de manière régulière avec son compère.', Null,'Merad','Kad', '1964-03-27');
insert into Professionnel Values('Protéger et servir, Brice de Nice, À la petite semaine, Mensonges et trahisons et plus si affinités, Un long dimanche de fiançailles, Faubourg 36, Les Chevaliers du ciel','Clovis Cornillac, né le 16 août 1968 à Lyon, est un acteur et réalisateur français. Il est le fils des comédiens Myriam Boyer et Roger Cornillac, et le demi-frère d''Arny Berry, comédien, metteur en scène et auteur de théâtre', Null,'Cornillac','Clovis', '1968-08-16');
insert into Professionnel Values('Protéger et servir, Cet obscur objet du désir, Rien que pour vos yeux, Rive droite, rive gauche, Trop belle pour toi, Lucie Aubrac','Carole Bouquet, née le 18 août 1957 à Neuilly-sur-Seine (Hauts-de-Seine), est une actrice française.', Null,'Bouquet','Carole', '1957-08-18');
insert into Professionnel Values('Protéger et servir, L''Arnacoeur, Rien à déclarer, La délicatesse, La Famille Bélier, Dikkenek','François Damiens, né le 17 janvier 1973 à Uccle, est un humoriste et acteur belge.', Null,'Damiens','François', '1973-01-17');



insert into Participer Values('Realisateur', 'Titanic', 'Cameron','James', '1954-08-16');
insert into Participer Values('Realisateur', 'Avatar', 'Cameron','James', '1954-08-16');
insert into Participer Values('Acteur', 'Titanic', 'DiCaprio','Leonardo', '1974-09-11');
insert into Participer Values('Acteur', 'Titanic', 'Winslet','Kate', '	1975-10-5');
insert into Participer Values('Realisateur','Demandez la permission aux enfants','Civanyan','Éric', '1974-01-01');
insert into Participer Values('Scenariste','Demandez la permission aux enfants', 'Breton','Guillaume', '1974-01-01');
insert into Participer Values('Acteur','Demandez la permission aux enfants','Bonnaire','Sandrine', '1967-05-31');
insert into Participer Values('Acteur','Demandez la permission aux enfants', 'Légitimus','Pascal', '1959-05-13');
insert into Participer Values('Acteur','Demandez la permission aux enfants', 'Parillaud','Anne', '1960-06-06');
insert into Participer Values('Acteur','Demandez la permission aux enfants', 'Cassignard','Pierre', '1965-12-19');
insert into Participer Values('Realisateur','Intouchables','Nakache','Olivier', '1973-05-15');
insert into Participer Values('Realisateur','Intouchables','Toledano','Éric', '1971-07-03');
insert into Participer Values('Acteur','Intouchables','Cluzet','François', '1955-09-21');
insert into Participer Values('Acteur','Intouchables','Sy','Omar', '1978-01-20');
insert into Participer Values('Acteur', 'Avatar','Worthington','Sam', '1976-08-02');
insert into Participer Values('Acteur', 'Avatar','Saldana','Zoe', '1978-07-19');
insert into Participer Values('Acteur', 'Avatar','Weaver','Sigourney', '1949-09-08');
insert into Participer Values('Acteur', 'Avatar','Rodríguez','Michelle', '1978-07-12');
insert into Participer Values('Acteur', 'Avatar','Ribisi','Giovanni', '1974-12-17');
insert into Participer Values('Realisateur', 'Protéger et servir', 'Lavaine','Éric', '1962-09-15');
insert into Participer Values('Acteur', 'Protéger et servir', 'Merad','Kad', '1964-03-27');
insert into Participer Values('Acteur', 'Protéger et servir','Cornillac','Clovis', '1968-08-16');
insert into Participer Values('Acteur', 'Protéger et servir','Bouquet','Carole', '1957-08-18');
insert into Participer Values('Acteur', 'Protéger et servir','Damiens','François', '1973-01-17');

Insert into Langue Values ('Francais');
Insert into Langue Values ('Anglais');
Insert into Langue Values ('Allemand');
Insert into Langue Values ('Espagnol');
Insert into Langue Values ('Hébreu');
Insert into Langue Values ('Portugais');
Insert into Langue Values ('Russe');
Insert into Langue Values ('Japonais');
Insert into Langue Values ('Italien');
Insert into Langue Values ('Arabe');

insert into Version
values ('1974-05-12','France','Bonus','Amazon', Null,'01:52:00','Protéger et Servir');
insert into Version
values ('1968-04-01','France','Bonus','Amazon', Null,'01:42:00','Demandez la Permission aux Enfants');
insert into Version
values ('1902-01-11','France','Bonus','Amazon',NULL,'01:49:00','Intouchables');
insert into Version
values ('1999-03-18','France','Java','France',NULL,'01:48:00','Avatar');
insert into Version
values ('2002-06-19','France','Base','France',NULL,'01:49:00','Avatar');
insert into Version
values ('1978-01-12','Etats-Unis','Base','Netflix',18,'01:42:00','Avatar');
insert into Version
values ('1986-02-21','Etats-Unis','Base','Netflix',18,'01:41:00','Demandez la Permission aux Enfants');
insert into Version
values ('1955-06-11','Etats-Unis','Base','Etats-Unis',16,'01:39:00','Titanic');
insert into Version
values ('1928-07-22','Etats-Unis','Java','Etats-Unis',16,'01:34:00','Avatar');
insert into Version
values ('1964-05-22','Etats-Unis','Base','Etats-Unis',10,'01:35:00','Intouchables');
insert into Version
values ('1991-03-26','Etats-Unis','Idée','Netflix',10,'01:48:00','Intouchables');
insert into Version
values ('1990-08-24','Etats-Unis','Java','Amazon',3,'01:16:00','Intouchables');
insert into Version
values ('1983-09-28','Etats-Unis','Java','Particulier',6,'01:15:00','Protéger et Servir');
insert into Version
values ('1974-04-30','Etats-Unis','Base','Particulier',10,'01:30:00','Demandez la Permission aux Enfants');
insert into Version
values ('1938-12-31','Etats-Unis','Java','Particulier',16,'01:43:00','Intouchables');
insert into Version
values ('1928-11-30','Etats-Unis','Base','Amazon',18,'02:12:00','Intouchables');
insert into Version
values ('1948-10-19','Corée','Idée','Particulier',18,'02:47:00','Protéger et Servir');
insert into Version
values ('1990-10-23','Japon','Bonus','Free',11,'02:25:00','Demandez la Permission aux Enfants');
insert into Version
values ('1995-12-28','Egypte','Idée','Free',18,'02:41:00','Intouchables');
insert into Version
values ('1996-11-30','Panama','Base','Netflix',10,'01:49:00','Avatar');
insert into Version
values ('1998-10-28','Palestine','Base','Israel',16,'01:57:00','Demandez la Permission aux Enfants');
insert into Version
values ('2010-06-19','Israel','Bonus','Palestine',13,'02:38:00','Intouchables');
insert into Version
values ('1998-03-25','Pangea','Idée','Free',14,'01:57:00','Demandez la Permission aux Enfants');
insert into Version
values ('2015-02-26','Atlantis','Idée','Free',15,'01:47:00','Protéger et Servir');
insert into Version
values ('2011-09-27','Belgique','Idée','Free',16,'03:10:00','Titanic');
insert into Version
values ('2014-08-29','France','Java','Free',10,'02:12:00','Titanic');
insert into Version
values ('2010-07-31','Danemark','Base','Particulier',6,'01:30:00','Protéger et Servir');
insert into Version
values ('2014-04-08','Russie','Java','Free',18,'02:12:00','Titanic');
insert into Version
values ('2015-05-04','Mali','Bonus','Particulier',14,'03:01:00','Protéger et Servir');
insert into Version
values ('2016-01-06','Congo','Idée','Free',16,'03:12:00','Titanic');




insert into Vocaliser
values ('1974-05-12','France','Bonus', 'Protéger et Servir', 'Anglais');
insert into Vocaliser
values ('1968-04-01','France','Bonus','Demandez la Permission aux Enfants', 'Anglais');
insert into Vocaliser
values ('1902-01-11','France','Bonus','Intouchables', 'Anglais');
insert into Vocaliser
values ('1999-03-18','France','Java','Avatar', 'Anglais');
insert into Vocaliser
values ('2002-06-19','France','Base','Avatar', 'Anglais');
insert into Vocaliser
values ('1978-01-12','Etats-Unis','Base','Avatar', 'Anglais');
insert into Vocaliser
values ('1986-02-21','Etats-Unis','Base','Demandez la Permission aux Enfants', 'Anglais');
insert into Vocaliser
values ('1955-06-11','Etats-Unis','Base','Titanic', 'Anglais');
insert into Vocaliser
values ('1928-07-22','Etats-Unis','Java','Avatar', 'Anglais');
insert into Vocaliser
values ('1964-05-22','Etats-Unis','Base','Intouchables', 'Anglais');
insert into Vocaliser
values ('1991-03-26','Etats-Unis','Idée','Intouchables', 'Anglais');
insert into Vocaliser
values ('1990-08-24','Etats-Unis','Java','Intouchables', 'Anglais');
insert into Vocaliser
values ('1983-09-28','Etats-Unis','Java','Protéger et Servir', 'Anglais');
insert into Vocaliser
values ('1974-04-30','Etats-Unis','Base','Demandez la Permission aux Enfants', 'Anglais');
insert into Vocaliser
values ('1938-12-31','Etats-Unis','Java','Intouchables', 'Anglais');
insert into Vocaliser
values ('1928-11-30','Etats-Unis','Base','Intouchables', 'Anglais');
insert into Vocaliser
values ('1948-10-19','Corée','Idée','Protéger et Servir', 'Anglais');
insert into Vocaliser
values ('1990-10-23','Japon','Bonus','Demandez la Permission aux Enfants', 'Anglais');
insert into Vocaliser
values ('1995-12-28','Egypte','Idée','Intouchables', 'Anglais');
insert into Vocaliser
values ('1996-11-30','Panama','Base','Avatar', 'Anglais');
insert into Vocaliser
values ('1998-10-28','Palestine','Base','Demandez la Permission aux Enfants', 'Anglais');
insert into Vocaliser
values ('2010-06-19','Israel','Bonus','Intouchables', 'Anglais');
insert into Vocaliser
values ('1998-03-25','Pangea','Idée','Demandez la Permission aux Enfants', 'Anglais');
insert into Vocaliser
values ('2015-02-26','Atlantis','Idée','Protéger et Servir', 'Anglais');
insert into Vocaliser
values ('2011-09-27','Belgique','Idée','Titanic', 'Anglais');
insert into Vocaliser
values ('2014-08-29','France','Java','Titanic', 'Anglais');
insert into Vocaliser
values ('2010-07-31','Danemark','Base','Protéger et Servir', 'Anglais');
insert into Vocaliser
values ('2014-04-08','Russie','Java','Titanic', 'Anglais');
insert into Vocaliser
values ('2015-05-04','Mali','Bonus','Protéger et Servir', 'Anglais');
insert into Vocaliser
values ('2016-01-06','Congo','Idée','Titanic', 'Anglais');

insert into Sous_titrer
values ('Anglais','1974-05-12','France','Bonus', 'Protéger et Servir');
insert into Sous_titrer
values ('Anglais','1968-04-01','France','Bonus','Demandez la Permission aux Enfants');
insert into Sous_titrer
values ('Anglais','1902-01-11','France','Bonus','Intouchables');
insert into Sous_titrer
values ('Anglais','1999-03-18','France','Java','Avatar');
insert into Sous_titrer
values ('Anglais','2002-06-19','France','Base','Avatar');
insert into Sous_titrer
values ('Anglais','1978-01-12','Etats-Unis','Base','Avatar');
insert into Sous_titrer
values ('Anglais','1986-02-21','Etats-Unis','Base','Demandez la Permission aux Enfants');
insert into Sous_titrer
values ('Anglais','1955-06-11','Etats-Unis','Base','Titanic');
insert into Sous_titrer
values ('Anglais','1928-07-22','Etats-Unis','Java','Avatar');
insert into Sous_titrer
values ('Anglais','1964-05-22','Etats-Unis','Base','Intouchables');
insert into Sous_titrer
values ('Anglais','1991-03-26','Etats-Unis','Idée','Intouchables');
insert into Sous_titrer
values ('Anglais','1990-08-24','Etats-Unis','Java','Intouchables');
insert into Sous_titrer
values ('Anglais','1983-09-28','Etats-Unis','Java','Protéger et Servir');
insert into Sous_titrer
values ('Anglais','1974-04-30','Etats-Unis','Base','Demandez la Permission aux Enfants');
insert into Sous_titrer
values ('Anglais','1938-12-31','Etats-Unis','Java','Intouchables');
insert into Sous_titrer
values ('Anglais','1928-11-30','Etats-Unis','Base','Intouchables');
insert into Sous_titrer
values ('Anglais','1948-10-19','Corée','Idée','Protéger et Servir');
insert into Sous_titrer
values ('Anglais','1990-10-23','Japon','Bonus','Demandez la Permission aux Enfants');
insert into Sous_titrer
values ('Anglais','1995-12-28','Egypte','Idée','Intouchables');
insert into Sous_titrer
values ('Anglais','1996-11-30','Panama','Base','Avatar');
insert into Sous_titrer
values ('Anglais','1998-10-28','Palestine','Base','Demandez la Permission aux Enfants');
insert into Sous_titrer
values ('Anglais','2010-06-19','Israel','Bonus','Intouchables');
insert into Sous_titrer
values ('Anglais','1998-03-25','Pangea','Idée','Demandez la Permission aux Enfants');
insert into Sous_titrer
values ('Anglais','2015-02-26','Atlantis','Idée','Protéger et Servir');
insert into Sous_titrer
values ('Anglais','2011-09-27','Belgique','Idée','Titanic');
insert into Sous_titrer
values ('Anglais','2014-08-29','France','Java','Titanic');
insert into Sous_titrer
values ('Anglais','2010-07-31','Danemark','Base','Protéger et Servir');
insert into Sous_titrer
values ('Anglais','2014-04-08','Russie','Java','Titanic');
insert into Sous_titrer
values ('Anglais', '2015-05-04','Mali','Bonus','Protéger et Servir');
insert into Sous_titrer
values ('Anglais', '2016-01-06','Congo','Idée','Titanic');

insert into Distinction Values('Oscar', 'Meilleur film', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleur réalisateur', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleure photographie', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleurs décors', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleurs costumes', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleur son', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleur montage', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleur montage sonore', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleurs effets visuels', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleure chanson', 'Los Angeles');
insert into Distinction Values('Oscar', 'Meilleure musique', 'Los Angeles');

insert into Distinction Values('Golden Globes', 'Meilleur film dramatique', 'Los Angeles');
insert into Distinction Values('Golden Globes', 'Meilleur réalisateur', 'Los Angeles');
insert into Distinction Values('Golden Globes', 'Meilleure chanson', 'Los Angeles');
insert into Distinction Values('Golden Globes', 'Meilleure musique', 'Los Angeles');

insert into Distinction Values('Blockbuster Awards', 'Meilleur acteur', 'Los Angeles');

insert into Distinction Values('César', 'Meilleur acteur', 'Paris');

insert into Distinction Values('Goya', 'Meilleur film européen', 'Madrid');


insert into Distinguer Values('1998', 'Titanic', 'DiCaprio','Leonardo', '1974-09-11','Blockbuster Awards', 'Meilleur acteur', 'Los Angeles');
insert into Distinguer Values('1998-03-23', 'Titanic', 'Cameron','James', '1954-08-16','Oscar', 'Meilleur réalisateur', 'Los Angeles');
insert into Distinguer Values('1998-03-23', 'Titanic', 'Cameron','James', '1954-08-16','Golden Globes', 'Meilleur réalisateur', 'Los Angeles');

insert into Distinguer Values('1998-03-23', 'Avatar', 'Cameron','James', '1954-08-16','Golden Globes', 'Meilleur réalisateur', 'Los Angeles');




insert into Distinguer Values('2013-02-17','Intouchables', 'Sy','Omar', '1978-01-20','César', 'Meilleur acteur', 'Paris');

insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleur film', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleure photographie', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleurs décors', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleurs costumes', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleur son', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleur montage', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleur montage sonore', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleurs effets visuels', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleure chanson', 'Los Angeles');
insert into DistinguerFilm Values('1998-03-23', 'Titanic','Oscar', 'Meilleure musique', 'Los Angeles');

insert into DistinguerFilm Values('1998-01-18', 'Titanic','Golden Globes', 'Meilleur film dramatique', 'Los Angeles');
insert into DistinguerFilm Values('1998-01-18', 'Titanic','Golden Globes', 'Meilleure chanson', 'Los Angeles');
insert into DistinguerFilm Values('1998-01-18', 'Titanic','Golden Globes', 'Meilleure musique', 'Los Angeles');

insert into DistinguerFilm Values('2010-03-07', 'Avatar','Oscar', 'Meilleure photographie', 'Los Angeles');
insert into DistinguerFilm Values('2010-03-07', 'Avatar','Oscar', 'Meilleurs décors', 'Los Angeles');
insert into DistinguerFilm Values('2010-03-07', 'Avatar','Oscar', 'Meilleurs effets visuels', 'Los Angeles');

insert into DistinguerFilm Values('2012-01-17', 'Avatar','Golden Globes', 'Meilleur film dramatique', 'Los Angeles');

insert into DistinguerFilm Values('2013-02-17','Intouchables','Goya', 'Meilleur film européen', 'Madrid');



insert into Physique
values (3518,'Protéger et Servir',1,'DVD',25,'1974-05-12','France','Bonus');
insert into Physique
values (21,'Protéger et Servir',5,'BlueRay',20,'1948-10-19','Corée','Idée');
insert into Physique
values (3519,'Protéger et Servir',4,'BlueRay',5,'2015-02-26','Atlantis','Idée');
insert into Physique
values (5197,'Protéger et Servir',1,'DVD',10,'2015-02-26','Atlantis','Idée');
insert into Physique
values (22222,'Protéger et Servir',0,'DVD',12,'1983-09-28','Etats-Unis','Java');
insert into Physique
values (16989,'Protéger et Servir',2,'VHS',18,'1983-09-28','Etats-Unis','Java');
insert into Physique
values (13219,'Avatar',0,'DVD',19,'1996-11-30','Panama','Base');
insert into Physique
values (846,'Avatar',0,'DVD',24,'1996-11-30','Panama','Base');
insert into Physique
values (21989,'Avatar',0,'DVD',11,'1999-03-18','France','Java');
insert into Physique
values (15115,'Avatar',1,'BlueRay',16,'1999-03-18','France','Java');
insert into Physique
values (9876,'Avatar',5,'DVD',2,'1978-01-12','Etats-Unis','Base');
insert into Physique
values (11566,'Avatar',2,'BlueRay',80,'1928-07-22','Etats-Unis','Java');
insert into Physique
values (15689,'Avatar',3,'DVD',15,'1928-07-22','Etats-Unis','Java');
insert into Physique
values (25486,'Titanic',5,'BlueRay',16,'2016-01-06','Congo','Idée');
insert into Physique
values (18498,'Titanic',4,'BlueRay',34,'2014-08-29','France','Java');
insert into Physique
values (1518,'Titanic',4,'BlueRay',21,'2011-09-27','Belgique','Idée');
insert into Physique
values (9870,'Titanic',3,'VHS',17,'2014-08-29','France','Java');
insert into Physique
values (10001,'Titanic',4,'BlueRay',9,'2016-01-06','Congo','Idée');
insert into Physique
values (11010,'Titanic',0,'DVD',38,'2014-08-29','France','Java');
insert into Physique
values (20200,'Intouchables',0,'VHS',75,'2010-06-19','Israel','Bonus');
insert into Physique
values (31050,'Intouchables',2,'DVD',6,'2010-06-19','Israel','Bonus');
insert into Physique
values (7802,'Intouchables',3,'DVD',16,'1938-12-31','Etats-Unis','Java');
insert into Physique
values (156,'Intouchables',4,'BlueRay',40,'1964-05-22','Etats-Unis','Base');
insert into Physique
values (1,'Intouchables',0,'BlueRay',12,'1964-05-22','Etats-Unis','Base');
insert into Physique
values (11,'Intouchables',1,'VHS',30,'1928-11-30','Etats-Unis','Base');
insert into Physique
values (111,'Demandez la Permission aux Enfants',1,'BlueRay',10,'1968-04-01','France','Bonus');
insert into Physique
values (1235,'Demandez la Permission aux Enfants',4,'DVD',42,'1990-10-23','Japon','Bonus');
insert into Physique
values (444,'Demandez la Permission aux Enfants',2,'DVD',11,'1990-10-23','Japon','Bonus');
insert into Physique
values (568,'Demandez la Permission aux Enfants',3,'DVD',28,'1998-10-28','Palestine','Base');
insert into Physique
values (462,'Demandez la Permission aux Enfants',4,'BlueRay',10,'1998-03-25','Pangea','Idée');
insert into Physique
values (486,'Demandez la Permission aux Enfants',2,'BlueRay',5,'1990-10-23','Japon','Bonus');


insert into Numérique
values ('Protéger et Servir',12,'1974-05-12','France','Bonus');
insert into Numérique
values ('Demandez la Permission aux Enfants',32,'1968-04-01','France','Bonus');
insert into Numérique
values ('Intouchables',20,'1902-01-11','France','Bonus');
insert into Numérique
values ('Avatar',10,'1999-03-18','France','Java');
insert into Numérique
values ('Avatar',11,'2002-06-19','France','Base');
insert into Numérique
values ('Avatar',12,'1978-01-12','Etats-Unis','Base');
insert into Numérique
values ('Demandez la Permission aux Enfants',21,'1986-02-21','Etats-Unis','Base');
insert into Numérique
values ('Titanic',11,'1955-06-11','Etats-Unis','Base');
insert into Numérique
values ('Avatar',32,'1928-07-22','Etats-Unis','Java');
insert into Numérique
values ('Intouchables',12,'1964-05-22','Etats-Unis','Base');
insert into Numérique
values ('Intouchables',5,'1991-03-26','Etats-Unis','Idée');
insert into Numérique
values ('Intouchables',9,'1990-08-24','Etats-Unis','Java');
insert into Numérique
values ('Protéger et Servir',14,'1983-09-28','Etats-Unis','Java');
insert into Numérique
values ('Demandez la Permission aux Enfants',20,'1974-04-30','Etats-Unis','Base');
insert into Numérique
values ('Intouchables',27,'1938-12-31','Etats-Unis','Java');
insert into Numérique
values ('Intouchables',28,'1928-11-30','Etats-Unis','Base');
insert into Numérique
values ('Protéger et Servir',29,'1948-10-19','Corée','Idée');
insert into Numérique
values ('Demandez la Permission aux Enfants',26,'1990-10-23','Japon','Bonus');
insert into Numérique
values ('Intouchables',17,'1995-12-28','Egypte','Idée');
insert into Numérique
values ('Avatar',18,'1996-11-30','Panama','Base');
insert into Numérique
values ('Demandez la Permission aux Enfants',16,'1998-10-28','Palestine','Base');
insert into Numérique
values ('Intouchables',18,'2010-06-19','Israel','Bonus');
insert into Numérique
values ('Demandez la Permission aux Enfants',22,'1998-03-25','Pangea','Idée');
insert into Numérique
values ('Protéger et Servir',61,'2015-02-26','Atlantis','Idée');
insert into Numérique
values ('Titanic',22,'2011-09-27','Belgique','Idée');
insert into Numérique
values ('Titanic',16,'2014-08-29','France','Java');
insert into Numérique
values ('Protéger et Servir',22,'2010-07-31','Danemark','Base');
insert into Numérique
values ('Titanic',112,'2014-04-08','Russie','Java');
insert into Numérique
values ('Protéger et Servir',14,'2015-05-04','Mali','Bonus');
insert into Numérique
values ('Titanic',25,'2016-01-06','Congo','Idée');

insert into LouerPhys values('2017-01-01','2018-01-12',9870,'Titanic','2014-08-29','France','Java','Wowday','Henrie','1968-11-20', 0);
insert into LouerPhys values('2017-05-22','2018-01-15',11,'Intouchables','1928-11-30','Etats-Unis','Base','Wowday','Henry','1968-10-17', 0);
insert into LouerPhys values('2017-06-30','2018-02-01',111,'Demandez la Permission aux Enfants','1968-04-01','France','Bonus','Whereday','Charle','1968-09-16', 0);
insert into LouerPhys values('2017-03-16','2018-03-13',444,'Demandez la Permission aux Enfants','1990-10-23','Japon','Bonus','Whenday','Thebase','1984-08-11', 0);
insert into LouerPhys values('2017-07-20','2018-02-05',15115,'Avatar','1999-03-18','France','Java','Allo','Mais','1929-06-21', 0);
insert into LouerPhys values('2017-06-30','2018-01-14',21,'Protéger et Servir','1948-10-19','Corée','Idée','Albert','Camus','1952-01-01', 0);
insert into LouerPhys values('2017-10-21','2018-02-15',22222,'Protéger et Servir','1983-09-28','Etats-Unis','Java','Wenenensday','Drop','2010-07-14', 0);
insert into LouerPhys values('2017-11-18','2018-03-01',18498,'Titanic','2014-08-29','France','Java','Tuesday','Mark','1999-06-19', 0);
insert into LouerPhys values('2017-11-16','2018-02-01',1235,'Demandez la Permission aux Enfants','1990-10-23','Japon','Bonus','Monday','Fetch','1968-05-11', 0);
insert into LouerPhys values('2017-08-12','2018-01-15',486,'Demandez la Permission aux Enfants','1990-10-23','Japon','Bonus','Soppyday','Joe','1948-04-04', 0);

insert into LouerNum
values ('2017-01-01','2018-01-12','Protéger et Servir','1974-05-12','France','Bonus','Weshwesh','lesamis','1995-04-26', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Demandez la Permission aux Enfants','1968-04-01','France','Bonus', 'Weshwesh','lesamis','1995-04-26', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Intouchables','1902-01-11','France','Bonus','Allo','Mais','1929-06-21', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Avatar','1999-03-18','France','Java','Allo','Mais','1929-06-21', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Avatar','2002-06-19','France','Base','Christ','Jesus','1984-08-22', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Avatar','1978-01-12','Etats-Unis','Base','Weshwesh','lesamis','1995-04-26', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Demandez la Permission aux Enfants','1986-02-21','Etats-Unis','Base','Christ','Jesus','1984-08-22', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Titanic','1955-06-11','Etats-Unis','Base','Christ','Jesus','1984-08-22', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Avatar','1928-07-22','Etats-Unis','Java','Jenova','Sephiroth','1963-10-23', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Intouchables','1964-05-22','Etats-Unis','Base','Jenova','Sephiroth','1963-10-23', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Intouchables','1991-03-26','Etats-Unis','Idée','Ramnstein','Leindeneim','0001-12-30', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Intouchables','1990-08-24','Etats-Unis','Java','Cherazade','Atila','1964-01-31', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Protéger et Servir','1983-09-28','Etats-Unis','Java','Jenova','Sephiroth','1963-10-23', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Demandez la Permission aux Enfants','1974-04-30','Etats-Unis','Base','Jenova','Sephiroth','1963-10-23', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Protéger et Servir','1948-10-19','Corée','Idée','Ramnstein','Leindeneim','0001-12-30', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Demandez la Permission aux Enfants','1990-10-23','Japon','Bonus','Ramnstein','Leindeneim','0001-12-30', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Avatar','1996-11-30','Panama','Base' ,'Cherazade','Atila','1964-01-31', 0);
insert into LouerNum
values ('2017-01-01','2018-01-12','Titanic','2011-09-27','Belgique','Idée','Cherazade','Atila','1964-01-31', 0);



create type Numero_t from smallint;
create type Film_t from varchar(52);
create type Real_t from varchar(25);
create type Nom_t from varchar(25);
create type Prenom_t from varchar(25);
create type PEGI_t from tinyint;
create type TitreVF_t from varchar(52);
create type DateV_t from date;
create type Pays_t from varchar(25);
create type Edition_t from varchar(25);
create type nomDistinctionT from varchar(25);
create type anneeT from int;
create type prixT from real;
create type dateNaiss_t from date;
create type support_t from varchar(25);
create type id_t from smallint;

create or alter procedure ProcPEGIreminder
@P_TitreVF TitreVF_t, @P_Date DateV_t, @P_Pays Pays_t, @P_Edition Edition_t,  @P_NumeroAbonne Numero_t
AS 
Declare @v_AgeP int = (Year(getdate())- Year((Select DateNaiss From Abonné Where Numero = @P_NumeroAbonne)))
Declare @v_PegiF int = (Select PEGI FROM Version WHERE TitreVF=@P_TitreVF and DateV = @P_Date and Pays = @P_Pays and Edition = @P_Edition)
Begin
IF (@v_AgeP < @v_PegiF)
    	BEGIN
    		Print 'Attention votre age est inferieur a l''age minimal conseillé'
			Return 1
    	END
Return 0
End

CREATE or alter TRIGGER PEGIreminderPhys
ON LouerPhys
FOR INSERT   
AS 
Declare @v_TitreVF TitreVF_t = (select TitreVF from inserted)
Declare @v_Date DateV_t = (select DateV from inserted)
Declare @v_Pays Pays_t = (select Pays from inserted)
Declare @v_Edition Edition_t = (select Edition from inserted)
Declare @v_NumAbo Numero_t = (select Numero from inserted, Abonné where inserted.Nom = Abonné.Nom and inserted.Prenom = Abonné.Prenom and inserted.DateNaiss = Abonné.DateNaiss)
Declare @v_Pegi Integer
Declare @v_Force Integer = (select Force from inserted)
DECLARE @return_status int;    
BEGIN 
   if(@v_Force <> 2)
	Begin
		exec @return_status = ProcPEGIreminder @v_TitreVF, @v_Date, @v_Pays, @v_Edition, @v_NumAbo
		if(@return_status = 1)
		begin
			print ('Insertion Annulé');
			ROLLBACK TRANSACTION;
		end
	End
	else
	Begin
		exec ProcPEGIreminder @v_TitreVF, @v_Date, @v_Pays, @v_Edition, @v_NumAbo
	End
END

CREATE or alter TRIGGER PEGIreminderNum
ON LouerNum
FOR INSERT   
AS 
Declare @v_TitreVF TitreVF_t = (select TitreVF from inserted)
Declare @v_Date DateV_t = (select DateV from inserted)
Declare @v_Pays Pays_t = (select Pays from inserted)
Declare @v_Edition Edition_t = (select Edition from inserted)
Declare @v_NumAbo Numero_t = (select Numero from inserted, Abonné where inserted.Nom = Abonné.Nom and inserted.Prenom = Abonné.Prenom and inserted.DateNaiss = Abonné.DateNaiss)
Declare @v_Pegi Integer
Declare @v_Force Integer = (select Force from inserted)
DECLARE @return_status int;    
BEGIN 
   if(@v_Force <> 2)
	Begin
		exec @return_status = ProcPEGIreminder @v_TitreVF, @v_Date, @v_Pays, @v_Edition, @v_NumAbo
		if(@return_status = 1)
		begin
			print ('Insertion Annulé');
			ROLLBACK TRANSACTION;
		end
	End
	else
	Begin
		exec ProcPEGIreminder @v_TitreVF, @v_Date, @v_Pays, @v_Edition, @v_NumAbo
	End
END

create or alter procedure PROCfilmNonLouable
AS 
Declare @v_Support support_t
Declare @v_TitreVF TitreVF_t
Declare @v_Date DateV_t
Declare @v_Pays Pays_t
Declare @v_Edition Edition_t
DECLARE C_Film CURSOR FOR
	select  Support, TitreVF, DateV, Pays, Edition 
	from Physique
	where Etat = 5;
begin
	open C_Film
	FETCH NEXT FROM C_Film into @v_Support, @v_TitreVF, @v_Date, @v_Pays, @v_Edition
	if @@FETCH_STATUS <> 0
		print 'Aucun Film non louable'
	Else
	Begin
		print 'Film non louable: '
		while @@FETCH_STATUS = 0
		Begin
			print @v_Support  + ' ' + @v_TitreVF + ' ' + convert(Varchar, @v_Date) +' ' + @v_Pays + ' ' + @v_Edition
			FETCH NEXT FROM C_Film into @v_Support, @v_TitreVF, @v_Date, @v_Pays, @v_Edition
		End
	end
	CLOSE C_Film
	DEALLOCATE C_Film
end

create or alter procedure PROCrealisateur
@P_film filmT
AS
DECLARE @v_nomR nomT
Begin
    Set @v_nomR = (select nom from participer where @P_film=titreVF And Role = 'Realisateur');
    print @P_film +' est realise par '+@v_nomR
End

create or alter procedure PROCfilmAct
@P_nomA nomT, @P_prenomA prenomT
AS
DECLARE @v_film filmT

Declare C_filmAct CURSOR FOR
select titreVF
from Participer
where @P_nomA=nom and @P_prenomA=prenom;

BEGIN

OPEN C_filmAct
FETCH NEXT FROM C_filmAct into @v_film

IF @@FETCH_STATUS <> 0
    print @P_prenomA + ' '+@P_nomA + 'n a joue dans aucun film'
ELSE
BEGIN
    print @P_prenomA +' '+@P_nomA +'a joue dans les films suivants : '
    While @@FETCH_STATUS = 0
    BEGIN
   	 print @v_film
   	 FETCH NEXT FROM C_filmAct into @v_film
    END
END
CLOSE C_filmAct
DEALLOCATE C_filmAct
END

create or alter procedure PROCdistinctionFilm
@P_film filmT
AS
DECLARE @v_nomDist nomDistinctionT 
DECLARE @v_categorieDist varchar(25)
DECLARE @v_lieuDist varchar(25) 
Declare C_filmDist CURSOR FOR
select nom, Categorie
from DistinguerFilm 
where @P_film=titreVF

Begin
OPEN C_filmDist
FETCH NEXT FROM C_filmDist into @v_nomDist, @v_categorieDist

IF @@FETCH_STATUS <> 0
    print 'aucune distinction pour le film' + '@P_film'
ELSE
BEGIN
    print @P_film +'a recu les distinction suivants : '
    While @@FETCH_STATUS = 0
    BEGIN
   	 print @v_nomDist + ' ' + @v_categorieDist
   	 FETCH NEXT FROM C_filmDist into @v_nomDist, @v_categorieDist
    END
END
CLOSE C_filmDist
DEALLOCATE C_filmDist
END

create or alter procedure PROCprixPhys
@P_annee_min anneeT, @P_annee_max anneeT
AS
DECLARE @v_film TitreVF_t
DECLARE @v_prix prixT
DECLARE C_prixPhys CURSOR FOR
select titreVF,prix
from Physique
where YEAR(dateV) between @P_annee_min and @P_annee_max
BEGIN
OPEN C_prixPhys
FETCH NEXT FROM C_prixPhys into @v_film,@v_prix

IF @@FETCH_STATUS <> 0
    print 'Aucun film n existe entre '+@P_annee_min+' et '+@P_annee_max
ELSE
BEGIN
    print 'Liste des films sortis entre '+ str(@P_annee_min) +' et ' + str(@P_annee_max)
    While @@FETCH_STATUS = 0
    BEGIN
   	 print @v_film +' '+str(@v_prix)
   	 FETCH NEXT FROM C_prixPhys into @v_film,@v_prix
    END
END
CLOSE C_prixPhys
DEALLOCATE C_prixPhys
END

create or alter procedure PROCprixNum
@P_annee_min anneeT, @P_annee_max anneeT
AS
DECLARE @v_film filmT
DECLARE @v_prix prixT

DECLARE C_prixNum CURSOR FOR
select titreVF,prix
from Numérique
where YEAR(dateV) between @P_annee_min and @P_annee_max

BEGIN

OPEN C_prixNum
FETCH NEXT FROM C_prixNum into @v_film,@v_prix

IF @@FETCH_STATUS <> 0
    print 'Aucun film n existe entre '+ str(@P_annee_min)+' et '+str(@P_annee_max)
ELSE
BEGIN
    print 'Liste des films sortis entre '+ str(@P_annee_min)+' et '+str(@P_annee_max)
    While @@FETCH_STATUS = 0
    BEGIN
   	 print @v_film +' '+str(@v_prix)
   	 FETCH NEXT FROM C_prixNum into @v_film,@v_prix
    END
END
CLOSE C_prixNum
DEALLOCATE C_prixNum

END

create or alter procedure EstAbo
@P_Prenom prenom_t, @P_Nom nom_t
AS
Declare @v_Numero Numero_t
Declare @true tinyint
set @true = 1;
Begin
    If (Exists (select * from Abonné where Nom=@P_Nom and Prenom = @P_Prenom))
   	 set @true = 0;
    Begin
   	 If @true=0
   		 begin
   		 set @v_Numero = (select Numero from Abonné where Nom=@P_Nom and Prenom = @P_Prenom);
   		 print ''+str(@v_Numero);
   		 end
   	 ELSE
   		 print 'Nup';
    End
End

create or alter procedure AfficheEdition
@P_TitreVF TitreVF_t
AS
Declare @v_Edition Edition_t
Declare ListEdition CURSOR FOR
    Select  Edition
    from Version
    where TitreVF = @P_TitreVF
BEGIN
	OPEN ListEdition
    FETCH NEXT FROM ListEdition into @v_Edition
    IF @@FETCH_STATUS <> 0
	Begin
   		print 'Aucune edition n''est repertoriée'
	 End
    ELSE
    BEGIN
   		While @@FETCH_STATUS = 0
		Begin
   			Print @v_Edition
   			FETCH NEXT FROM ListEdition into @v_Edition
		End
    END
	CLOSE ListEdition
	DEALLOCATE ListEdition
END

create or alter procedure PROCfilmreal
@P_nomReal Nom_t, @P_prenomReal Prenom_t
AS
Declare @v_film TitreVF_t
DECLARE C_filmDeReal CURSOR FOR
	select TitreVF
	from Participer
	where Nom=@P_nomReal 
	and Prenom=@P_prenomReal 
	and Role = 'Realisateur' 

BEGIN
	OPEN C_filmDeReal
	FETCH NEXT FROM C_filmDeReal into @v_film
	IF @@FETCH_STATUS <> 0
	Begin
		print 'Aucun film de ce réalisateur n''est repertorié dans la base de donnée'
	End
	ELSE
	BEGIN
		print 'les films de ' + @P_nomReal + ' sont:'
		while @@FETCH_STATUS = 0
		BEGIN
   			print @v_film
   			FETCH NEXT FROM C_filmDeReal into @v_film
		END
	END
	CLOSE C_filmDeReal
	DEALLOCATE C_filmDeReal
END

create procedure rachat
@P_Id id_t
AS
Declare @v_Edition Edition_t
Declare @v_TitreVF TitreVF_t
Declare @v_Pays    Pays_t
Declare @v_DateV DateV_t
set @v_Edition = (Select Edition From Physique Where id = @P_Id);
set @v_TitreVF = (Select TitreVF From Physique where id = @P_Id);
set @v_Pays = (Select Pays From Physique Where id = @P_Id);
set @v_DateV = (Select DateV From Physique Where id = @P_Id);
Begin
delete From Physique Where id = @P_Id and Edition = @v_Edition and TitreVF = @v_TitreVF and Pays = @v_Pays and DateV = @v_DateV;
print'id suppr'
IF ((select COUNT(*) From Physique Where Edition = @v_Edition and TitreVF = @v_TitreVF and Pays = @v_Pays and DateV = @v_DateV)=0)
    Delete From Version Where Edition = @v_Edition and TitreVF = @v_TitreVF and Pays = @v_Pays and DateV = @v_DateV
    print'version suppr'
    Begin
    IF ((select COUNT(*) From Version Where @v_TitreVF = TitreVF)=0)
   	 print'film suppr'
   	 delete from Film Where  TitreVF =@v_TitreVF
    end
End


drop procedure trending

create procedure trending
AS
Declare @v_TitreVF TitreVF_t
Declare @v_count int
DECLARE C_FilmTrend CURSOR FOR
    select TitreVF, count(*)
	from LouerPhys
	group by TitreVF
    order by count(*) desc

Begin
    open C_FilmTrend
    FETCH NEXT FROM C_FilmTrend into @v_TitreVF, @v_count
	if @@FETCH_STATUS <> 0
    	print 'Aucun Film trending'
	Else
   	 Begin
    	print 'Film trending: '
    	while @@FETCH_STATUS = 0
   		 Begin
        	print left(@v_TitreVF + replicate('.',52),52) +': '+ convert(varchar, @v_count)
        	FETCH NEXT FROM C_FilmTrend into @v_TitreVF, @v_count
   		 End
   	 end
	CLOSE C_FilmTrend
	DEALLOCATE C_FilmTrend
end

drop procedure durable

create procedure durable
AS
Declare @v_TitreVF TitreVF_t
Declare @v_avg int
DECLARE C_durable CURSOR FOR
    select TitreVF, avg(Etat)
	from Physique
	group by TitreVF
    order by count(Etat)

Begin
    open C_durable
    FETCH NEXT FROM C_durable into @v_TitreVF, @v_avg
	if @@FETCH_STATUS <> 0
    	print 'Aucun Film'
	Else
   	 Begin
    	print 'Film trending: '
    	while @@FETCH_STATUS = 0
   		 Begin
        	print left(@v_TitreVF + replicate('.',52),52) +': '+ convert(varchar, @v_avg)
        	FETCH NEXT FROM C_durable into @v_TitreVF, @v_avg
   		 End
   	 end
	CLOSE C_durable
	DEALLOCATE C_durable
end

drop procedure PROClitigeNum

create procedure PROClitigeNum
@P_numClient NumAboT
AS
Declare @v_titreNum FilmT
Declare @v_nb int

DECLARE C_litigeNum CURSOR FOR
select titreVF
from Film,Version,Numerique,LouerNum,Abonnement,Abonne
where Film.titreVF=Version.titreVF and Version.dateV=Numerique.dateV and Version.pays=Numerique.pays and pays.Edition=Version.edition
and Numerique.dateV=louerNum.dateV and Numerique.pays=louerNum.pays and Numerique.edition=louerNum.edition and LouerNum.numero=Abonne.numero
and Abonne.nom_abonnement=Abonnement.nom and titreVF=@v_titreNum and Abonne.numero=@P_numclient
set @v_nb=0

BEGIN

OPEN C_litigeNum
FETCH NEXT FROM C_litigeNum into @v_titreNum

IF @@FETCH_STATUS <> 0
    print 'Le client numero'+str(@P_numClient)+' n a aucun film en retard'
ELSE
BEGIN
    While @@FETCH_STATUS = 0
    BEGIN
   	 set @v_nb=@v_nb+1
   	 FETCH NEXT FROM C_duree into @v_titreNum
    END
    print 'Le client numero'+str(@P_numClient)+' a '+str(@v_nb)+' film(s) en retard'
END
CLOSE C_litigeNum
DEALLOCATE C_litigeNum

END

drop procedure PROClitigePhys

create procedure PROClitigePhys
@P_numClient NumAboT
AS
Declare @v_titrePhys FilmT
Declare @v_nb int

DECLARE C_litigePhys CURSOR FOR
select titreVF
from Film,Version,Physique,LouerPhys,Abonnement,Abonne
where Film.titreVF=Version.titreVF and Version.dateV=Numerique.dateV and Version.pays=Numerique.pays and pays.Edition=Version.edition
and Physique.dateV=louerPhys.dateV and Physique.pays=louerPhys.pays and Physique.edition=louerPhys.edition and LouerPhys.numero=Abonne.numero
and Physique.id=LouerPhys.id and Abonne.nom_abonnement=Abonnement.nom and titreVF=@v_titrePhys and Abonne.numero=@P_numclient
set @v_nb=0

BEGIN

OPEN C_litigePhys
FETCH NEXT FROM C_litigePhys into @v_titrePhys

IF @@FETCH_STATUS <> 0
    print 'Le client numero'+str(@P_numClient)+' n a aucun film en retard'
ELSE
BEGIN
    While @@FETCH_STATUS = 0
    BEGIN
   	 set @v_nb=@v_nb+1
   	 FETCH NEXT FROM C_duree into @v_titrePhys
    END
    print 'Le client numero'+str(@P_numClient)+' a '+str(@v_nb)+' film(s) en retard'
END
CLOSE C_litigePhys
DEALLOCATE C_litigePhys

END


